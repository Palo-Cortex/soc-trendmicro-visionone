# 🛡️ SOC Trend Micro Vision One Integration Enhancement for Cortex XSIAM

This repository enhances the native **Trend Micro Vision One (TMV1)** integration within **Palo Alto Networks Cortex XSIAM**.  
It provides layouts, correlation rules, mappers, and data model extensions to optimize XDR visibility, enrich alerts, and automate SOC workflows.

---

## ⚙️ Prerequisites

- Configure **Trend Micro Vision One** integration via **Marketplace**.
- Ensure your API credentials include access to **Alerts**, **Endpoints**, and **Indicators**.
- Disable redundant alert fetch if using a **custom connector** or **data broker**.

---

## 🚀 Purpose

This pack enables Cortex XSIAM to more effectively operationalize **Trend Micro Vision One** telemetry by:

- 📊 Centralizing XDR alerts across endpoint, email, identity, and network layers.
- ⚙️ Automating enrichment and triage for Vision One incidents.
- 🔁 Reducing alert fatigue by grouping related detections into contextual incidents.
- 🧩 Enabling correlation with identity, network, and cloud data sources.

---

## 📦 What's Included

| Component | Description |
|------------|-------------|
| **Layouts** | Custom analyst layouts highlighting key Vision One alert fields, entities, and indicators. |
| **Correlation Rules** | MITRE tactic–aligned rules for grouping alerts across execution, persistence, and discovery stages. |
| **Data Models** | Normalized datasets that map Vision One alerts to XSIAM’s schema for consistent analytics. |
| **Automation Scripts** |  |
| `displayVisionOneAlert_xsiam` | Displays enriched Vision One alert details dynamically within layout sections. |
| `displayVisionOneIndicators_xsiam` | Renders associated indicators and threat objects linked to the alert. |
| `displayVisionOneHostStatus_xsiam` | Shows endpoint status, protection level, and recent activity in structured form. |

---

## 🧠 Analyst Benefits

- Unified XDR visibility within Cortex XSIAM.
- Enriched incident triage with endpoint and identity context.
- Reduced time to detect and respond (MTTD/MTTR).
- Consistent alert structure across all SOC Framework integrations.

> 🔄 **Fully compatible with the [SOC Optimization Framework](https://github.com/Palo-Cortex/soc-optimization-framework)** for cross-vendor correlation and automation.

---

## 🔗 Use Case Compatibility

- **Endpoint Threat Detection**
- **Email Security Correlation**
- **User Behavior Analytics (UBA)**
- **Lateral Movement & Persistence Detection**
- **Automated Host Triage & Containment**

---

## ⚙️ Integration Requirements

- Active **Cortex XSIAM** tenant.
- **Trend Micro Vision One** data ingested via the XSIAM connector or broker.
- Connectivity to the Vision One API endpoints (via HTTPS).
- This pack automatically handles normalization through mappers and data models.

---

## 🛠️ How to Use

1. Clone this repository.
2. Use the [Demisto “XSOAR” SDK](https://github.com/demisto/demisto-sdk) to upload content to Cortex XSIAM.
3. Choose and enable correlation rules based on your desired MITRE tactics.
4. Deploy and validate layouts, models, and dashboards.
5. Tune correlation logic for your environment’s alert volume and threat profile.

---

## 🛠 Installation & Configuration

### 📦 Installing the Pack into Cortex XSIAM

To install this content pack using the [Demisto SDK](https://github.com/demisto/demisto-sdk), run:

```bash
demisto-sdk upload -x -z -i ./Packs/soc-trendmicro-visionone
```

> **Note:**
> - `-x` ensures the pack is zipped before upload.
> - `-z` uploads the zipped pack.
> - Adjust the path (`-i`) to match your local repository structure.

Ensure your environment is configured with your XSIAM host and API key using either:

- A `.env` file, **or**
- Setting the following environment variables:
    - `DEMISTO_BASE_URL`
    - `DEMISTO_API_KEY`
    - `XSIAM_AUTH_ID`

---

### 🧩 Post-Installation Configuration

After upload, configure a layout rule for Vision One alerts:

1. Go to **Settings → Configurations → Object Setup → Layout Rules**.
2. Click **Add Layout Rule**.
3. Configure the rule with the following values:
    - **Rule Name:** `Trend Micro Vision One`
    - **Layout to Display:** `Vision One Alert Layout`
    - **Alert Type:** `trend_micro_vision_one_v3_generic_alert`

> ⚠️ **Important:**  
> The `Alert Type` must exactly match the dataset name generated by the integration:  
> `trend_micro_vision_one_v3_generic_alert`

---

## 🧩 Correlation Rules Overview

Enable the following MITRE-aligned rules to organize Vision One alerts into contextual incidents:

| Correlation Rule Name | MITRE Tactic |
|------------------------|--------------|
| `Trend Micro Vision One – Execution` | TA0002 – Execution |
| `Trend Micro Vision One – Persistence` | TA0003 – Persistence |
| `Trend Micro Vision One – Credential Access` | TA0006 – Credential Access |
| `Trend Micro Vision One – Discovery` | TA0007 – Discovery |
| `Trend Micro Vision One – Lateral Movement` | TA0008 – Lateral Movement |
| `Trend Micro Vision One – Defense Evasion` | TA0005 – Defense Evasion |

---

## 🧠 Validation Tips

- Validate dataset population under **Data → Datasets → trend_micro_vision_one_v3_generic_alert**.
- Confirm layout rules apply only to Vision One alerts.
- Verify correlation rules generate grouped incidents per tactic.

## 🤝 Contributing

Contributions are welcome via pull requests or GitHub issues.  
When contributing, follow existing naming and packaging conventions in the **SOC Framework** repositories.

---

## 📚 Related Resources

- [Trend Micro Vision One API Documentation](https://automation.trendmicro.com/xdr/api/)
- [Cortex XSIAM Documentation](https://docs.paloaltonetworks.com/cortex/cortex-xsiam)
- [SOC Optimization Framework](https://github.com/Palo-Cortex/soc-optimization-framework)

---

## 🏷️ Tags

`TrendMicro` `VisionOne` `XDR` `Endpoint` `Email` `XSIAM` `SOC` `Automation`

---

Once configured, all **Trend Micro Vision One alerts** will automatically display the custom layout and feed into MITRE-aligned correlation rules included in this pack.
